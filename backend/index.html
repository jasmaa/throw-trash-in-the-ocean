<!doctype html>
<html lang="en">

<head>
    <title>Throw Trash in the Ocean</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/socket.io-client@2/dist/socket.io.js"></script>
</head>

<body>

    <div id="pollute-btn" class="btn btn-primary">Press Me!</div>
    <div id="world-stat"></div>
    <div id="profit"></div>

    <script>

        const roomName = window.location.pathname.split("/")[2]; //temp
        let userID = null; // temp

        const socket = io.connect('http://localhost:3001');
        const polluteBtn = document.getElementById('pollute-btn');
        const worldStatLabel = document.getElementById('world-stat');
        const profitLabel = document.getElementById('profit');

        socket.on('connect', data => {
            socket.emit('join', {
                user_id: userID,
                room_name: roomName,
            });
        });

        socket.on('sync', data => {
            worldStatLabel.innerHTML = JSON.stringify(data);
        });

        socket.on('join', data => {
            console.log(`Joined ${data['user_id']}!`);
            userID = data['user_id'];
        });

        socket.on('pollute', data => {
            profitLabel.innerHTML = JSON.stringify(data);
        });

        polluteBtn.addEventListener('click', e => {
            socket.emit('pollute', {
                user_id: userID,
                room_name: roomName,
            });
        });

    </script>

</body>

</html>